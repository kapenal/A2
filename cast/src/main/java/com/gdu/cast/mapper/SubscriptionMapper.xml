<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gdu.cast.mapper.SubscriptionMapper">
	<select id="selectSubscriptionList" resultType="com.gdu.cast.vo.Subscription">
		SELECT subscription_no subscriptionNo, subscription_name subscriptionName, subscription_pay subscriptionPay, 
				subscription_hotel subscriptionHotel, subscription_experience subscriptionExperience,
				subscription_exhibition_enum subscriptionExhibitionEnum, create_date createDate, update_date updateDate
		FROM subscription
	</select>
	<!-- subscriptionNo 해당하는 결제값 조회 -->
	<select id="selectSubscriptionPay" parameterType="int" resultType="int">
		Select subscription_pay subscriptionPay
		FROM subscription
		WHERE subscription_no = #{subscriptionNo}
	</select>
	<!-- 사업자 가입 요청 승인시 구독결제테이블에 입력 -->
	<insert id="insertSubscriptionAmount" parameterType="map">
		INSERT INTO subscription_amount(
			subscription_no,
			ceo_id,
			subscription_pay,
			create_date,
			update_date	
		)
		VALUES(
			#{subscriptionNo},
			#{ceoId},
			#{amount},
			NOW(),
			NOW()
		)
	</insert>
	<!-- 사업자 구독 정보 조회 -->
	<select id="selectSubscriptionNo" parameterType="String" resultType="int">
		SELECT subscription_no subscriptionNo
		FROM ceo
		WHERE ceo_id = #{ceoId}
	</select>
	
	<!-- 사업자 구독 변경 -->
	<update id="updateCeoSubscription" parameterType="map">
		UPDATE ceo SET
			subscription_no = #{subscriptionNo}, update_date = now()
		WHERE ceo_id = #{ceoId}
	</update>
</mapper>